---
name: batch-file-search
description: 批量搜索文件内容，支持关键字匹配、正则表达式、文件类型筛选，适用于查找包含特定信息的文档。
compatibility: 支持 Windows/macOS/Linux，依赖 Python 3.6+，需文件系统读取权限。
metadata:
  version: "1.0"
  author: "Custom AI Agent"
  update_time: "2025-12-23"
---

# 批量搜索文件技能
## 适用场景
当需要快速查找包含特定内容的文件时使用，例如：
- 查找包含“合同编号2024001”的所有文档；
- 搜索项目中所有包含 `TODO` 注释的代码文件；
- 统计包含特定关键词的日志文件数量。

## 核心参数（用户需提供）
1. `search_path`：必填，搜索的根目录路径；
2. `keyword`：必填，搜索的关键词或正则表达式；
3. `is_regex`：可选，是否使用正则表达式（默认 False）；
4. `file_filter`：可选，文件类型筛选（如 ".txt,.md"，留空则搜索所有文本文件）；
5. `case_sensitive`：可选，是否区分大小写（默认 False）。

## 执行步骤
1. 校验用户输入：确认 `search_path` 存在且有读取权限；
2. 遍历目录下符合 `file_filter` 的所有文件（递归搜索子目录）；
3. 逐个读取文件内容：
   - 尝试以 UTF-8 编码读取，失败则尝试系统默认编码；
   - 若文件过大（>10MB），则按行读取避免内存溢出；
4. 进行匹配搜索：
   - 若 `is_regex=True`：使用正则匹配；
   - 若 `is_regex=False`：使用字符串包含匹配（根据 `case_sensitive` 决定是否忽略大小写）；
5. 记录匹配结果：包含关键词的文件路径、匹配行号、匹配内容片段；
6. 返回执行报告：匹配文件数量、详细匹配列表。

## 注意事项
1. 仅支持文本文件搜索，自动跳过二进制文件（如图片、视频、exe）；
2. 搜索结果限制前100个匹配项，避免输出过多；
3. 注意保护隐私，避免搜索系统敏感目录。
